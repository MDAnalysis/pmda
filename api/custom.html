
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>2.1.2. Parallel Analysis helper — pmda.custom &#8212; PMDA 0.1.0+3.g80a0319 documentation</title>
    <link rel="stylesheet" href="../_static/alabaster.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.1.0+3.g80a0319',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="search" type="application/opensearchdescription+xml"
          title="Search within PMDA 0.1.0+3.g80a0319 documentation"
          href="../_static/opensearch.xml"/>
    <link rel="shortcut icon" href="../_static/mdanalysis-logo.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="2.2.1. RMSD analysis tools — pmda.rms" href="rms.html" />
    <link rel="prev" title="2.1.1. Parallel Analysis building blocks — pmda.parallel" href="parallel.html" />
   
  <link rel="stylesheet" href="../_static/custom.css" type="text/css" />
  
  
  <meta name="viewport" content="width=device-width, initial-scale=0.9, maximum-scale=0.9" />

  </head>
  <body>
  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <span class="target" id="module-pmda.custom"></span><div class="section" id="parallel-analysis-helper-pmda-custom">
<h1>2.1.2. Parallel Analysis helper — <a class="reference internal" href="#module-pmda.custom" title="pmda.custom"><code class="xref py py-mod docutils literal"><span class="pre">pmda.custom</span></code></a><a class="headerlink" href="#parallel-analysis-helper-pmda-custom" title="Permalink to this headline">¶</a></h1>
<p>This module contains the class <cite>AnalysisFromFunction</cite> and the decorator
<cite>analysis_class</cite>. Both can be used to generate custom analysis classes that can
be run in parallel from functions that take one or more atom groups from the
same universe and return a value.</p>
<dl class="class">
<dt id="pmda.custom.AnalysisFromFunction">
<em class="property">class </em><code class="descclassname">pmda.custom.</code><code class="descname">AnalysisFromFunction</code><span class="sig-paren">(</span><em>function</em>, <em>universe</em>, <em>*args</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pmda/custom.html#AnalysisFromFunction"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pmda.custom.AnalysisFromFunction" title="Permalink to this definition">¶</a></dt>
<dd><p>Create an analysis from a function working on AtomGroups</p>
<p>The function that is used</p>
<dl class="attribute">
<dt id="pmda.custom.AnalysisFromFunction.results">
<code class="descname">results</code><a class="headerlink" href="#pmda.custom.AnalysisFromFunction.results" title="Permalink to this definition">¶</a></dt>
<dd><p><em>ndarray</em> – results of calculation are stored after call to <code class="docutils literal"><span class="pre">run</span></code></p>
</dd></dl>

<p class="rubric">Example</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Create a new function to analyze a single frame</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">rotation_matrix</span><span class="p">(</span><span class="n">mobile</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">mda</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">align</span><span class="o">.</span><span class="n">rotation_matrix</span><span class="p">(</span><span class="n">mobile</span><span class="p">,</span> <span class="n">ref</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># now run an analysis using the standalone function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span> <span class="o">=</span> <span class="n">AnalysisFromFunction</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">,</span>
<span class="go">                               trajectory, mobile, ref).run()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rot</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Raises:</th><td class="field-body">ValueError : if <code class="docutils literal"><span class="pre">function</span></code> has the same kwargs as <code class="docutils literal"><span class="pre">BaseAnalysis</span></code></td>
</tr>
</tbody>
</table>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pmda.custom.analysis_class" title="pmda.custom.analysis_class"><code class="xref py py-class docutils literal"><span class="pre">analysis_class</span></code></a></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a>) – function to evaluate at each frame. The first arguments are assumed
to be ‘mobile’ Atomgroups if they belong to the same universe. All
other Atomgroups are assumed to be reference. Here ‘mobile’ means
they will be iterated over.</li>
<li><strong>Universe</strong> (<code class="xref py py-class docutils literal"><span class="pre">Universe</span></code>) – a <code class="xref py py-class docutils literal"><span class="pre">MDAnalysis.core.groups.Universe</span></code> (the
<cite>atomgroups</cite> must belong to this Universe)</li>
<li><strong>*args</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#list" title="(in Python v3.6)"><em>list</em></a>) – arguments for <code class="docutils literal"><span class="pre">function</span></code></li>
<li><strong>**kwargs</strong> (<a class="reference external" href="https://docs.python.org/3/library/stdtypes.html#dict" title="(in Python v3.6)"><em>dict</em></a>) – keyword arguments for <code class="docutils literal"><span class="pre">function</span></code>. keyword arguments with name
‘universe’ or ‘atomgroups’ will be ignored! Mobile atomgroups to
analyze can not be passed as keyword arguments currently.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="pmda.custom.analysis_class">
<code class="descclassname">pmda.custom.</code><code class="descname">analysis_class</code><span class="sig-paren">(</span><em>function</em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/pmda/custom.html#analysis_class"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#pmda.custom.analysis_class" title="Permalink to this definition">¶</a></dt>
<dd><p>Transform a function operating on a single frame to an analysis class</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>function</strong> (<a class="reference external" href="https://docs.python.org/3/library/functions.html#callable" title="(in Python v3.6)"><em>callable</em></a>) – The function that can analyze a single or more atomgroups. It is always
assumed that the mobile atomgroups (which will be iterated over) come
first. All atomgroups that come directly after the first that are part
of the same universe will iterated over</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">A new AnalysisClass with function as analysis</td>
</tr>
</tbody>
</table>
<p class="rubric">Example</p>
<p>For an usage in a library we recommend the following style:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">rotation_matrix</span><span class="p">(</span><span class="n">mobile</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">mda</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">align</span><span class="o">.</span><span class="n">rotation_matrix</span><span class="p">(</span><span class="n">mobile</span><span class="p">,</span> <span class="n">ref</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">RotationMatrix</span> <span class="o">=</span> <span class="n">analysis_class</span><span class="p">(</span><span class="n">rotation_matrix</span><span class="p">)</span>
</pre></div>
</div>
<p>It can also be used as a decorator:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nd">@analysis_class</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">RotationMatrix</span><span class="p">(</span><span class="n">mobile</span><span class="p">,</span> <span class="n">ref</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">return</span> <span class="n">mda</span><span class="o">.</span><span class="n">analysis</span><span class="o">.</span><span class="n">align</span><span class="o">.</span><span class="n">rotation_matrix</span><span class="p">(</span><span class="n">mobile</span><span class="p">,</span> <span class="n">ref</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">rot</span> <span class="o">=</span> <span class="n">RotationMatrix</span><span class="p">(</span><span class="n">u</span><span class="o">.</span><span class="n">trajectory</span><span class="p">,</span> <span class="n">mobile</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">run</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">rot</span><span class="o">.</span><span class="n">results</span><span class="p">)</span>
</pre></div>
</div>
<div class="admonition seealso">
<p class="first admonition-title">See also</p>
<p class="last"><a class="reference internal" href="#pmda.custom.AnalysisFromFunction" title="pmda.custom.AnalysisFromFunction"><code class="xref py py-func docutils literal"><span class="pre">AnalysisFromFunction()</span></code></a></p>
</div>
</dd></dl>

</div>


          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<p class="logo">
  <a href="../index.html">
    <img class="logo" src="../_static/logos/pmda-logo.png" alt="Logo"/>
    
    <h1 class="logo logo-name">PMDA</h1>
    
  </a>
</p>



<p class="blurb">Parallel Molecular Dynamics Analysis</p>








<h3>Navigation</h3>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../userguide.html">1. User Guide</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../api.html">2. API for <code class="docutils literal"><span class="pre">pmda</span></code></a><ul class="current">
<li class="toctree-l2 current"><a class="reference internal" href="../api.html#building-blocks">2.1. Building blocks</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="parallel.html">2.1.1. Parallel Analysis building blocks — <code class="docutils literal"><span class="pre">pmda.parallel</span></code></a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">2.1.2. Parallel Analysis helper — <code class="docutils literal"><span class="pre">pmda.custom</span></code></a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../api.html#pre-defined-parallel-analysis-tasks">2.2. Pre-defined parallel analysis tasks</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../references.html">3. References</a></li>
</ul>


<hr />
<ul>
    
    <li class="toctree-l1"><a href="https://www.mdanalysis.org">MDAnalysis</a></li>
    
    <li class="toctree-l1"><a href="https://dask.pydata.org">Dask</a></li>
    
    <li class="toctree-l1"><a href="https://distributed.readthedocs.io/">distributed</a></li>
    
</ul>
<div class="relations">
<h3>Related Topics</h3>
<ul>
  <li><a href="../index.html">Documentation overview</a><ul>
  <li><a href="../api.html">2. API for <code class="docutils literal"><span class="pre">pmda</span></code></a><ul>
      <li>Previous: <a href="parallel.html" title="previous chapter">2.1.1. Parallel Analysis building blocks — <code class="docutils literal"><span class="pre">pmda.parallel</span></code></a></li>
      <li>Next: <a href="rms.html" title="next chapter">2.2.1. RMSD analysis tools — <code class="docutils literal"><span class="pre">pmda.rms</span></code></a></li>
  </ul></li>
  </ul></li>
</ul>
</div>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="footer">
      &copy;2018, Max Linke, Oliver Beckstein.
      
      |
      Powered by <a href="http://sphinx-doc.org/">Sphinx 1.6.7</a>
      &amp; <a href="https://github.com/bitprophet/alabaster">Alabaster 0.7.10</a>
      
      |
      <a href="../_sources/api/custom.rst.txt"
          rel="nofollow">Page source</a>
    </div>

    
    <a href="https://github.com/MDAnalysis/pmda" class="github">
        <img style="position: absolute; top: 0; right: 0; border: 0;" src="https://s3.amazonaws.com/github/ribbons/forkme_right_darkblue_121621.png" alt="Fork me on GitHub"  class="github"/>
    </a>
    

    
  </body>
</html>